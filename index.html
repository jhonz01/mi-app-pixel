<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pa' ti mi cachetona ðŸ’–</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #222;
      font-family: 'Press Start 2P', Arial, sans-serif;
      text-align: center;
      height: 100%;
      width: 100vw;
    }
    h1 {
      margin: 10px 0 0 0;
      font-size: 5vw;
      color: #fff;
      text-shadow: 2px 2px 0 #000;
      letter-spacing: 2px;
    }
    #mensaje {
      background: rgba(0,0,0,0.7);
      color: #fff;
      padding: 10px 18px;
      border-radius: 12px;
      display: inline-block;
      margin: 12px auto 8px auto;
      font-size: 4vw;
      box-shadow: 0 2px 8px #0006;
      min-width: 60vw;
      max-width: 90vw;
    }
    #gameCanvas {
      display: block;
      margin: 0 auto;
      background: #222;
      width: 100vw;
      max-width: 100vw;
      height: 60vw;
      max-height: 70vw;
      image-rendering: pixelated;
      border: 2px solid #333;
    }
    .controles {
      position: fixed;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      z-index: 10;
      width: 95vw;
      justify-content: center;
      flex-wrap: wrap;
    }
    .controles button {
      background: #222;
      border: 4px solid #fff;
      color: #fff;
      font-family: 'Press Start 2P', Arial, sans-serif;
      font-size: 3vw;
      padding: 8px 12px;
      cursor: pointer;
      image-rendering: pixelated;
      box-shadow: 4px 4px 0 #000;
      transition: all 0.1s;
      min-width: 80px;
    }
    .controles button:active {
      background: #ff66a3;
      color: #000;
      box-shadow: 2px 2px 0 #000;
      transform: translate(2px,2px);
    }
    @media (max-width: 600px) {
      h1 { font-size: 7vw; }
      #mensaje { font-size: 5vw; }
      #gameCanvas { height: 60vw; }
      .controles button { font-size: 4vw; min-width: 60px; }
    }
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
  </style>
</head>
<body>
  <h1>Pa' ti mi cachetona ðŸ’–</h1>
  <div id="mensaje">Paâ€™ ti mi cachetona hermosa ðŸŒ¹</div>
  <canvas id="gameCanvas" width="320" height="160"></canvas>
  <div class="controles">
    <button id="btnAutoWalk">MOVE</button>
    <button id="btnMusica">PLAY</button>
    <button id="btnVoz">VOICE</button>
    <button id="btnMensaje">MSG</button>
  </div>

  <!-- Audios -->
  <audio id="musica" src="musica.mp3"></audio>
  <audio id="voz" src="mi_voz.mp3"></audio>

  <script>
    const mensajes = [
      "Paâ€™ ti mi cachetona hermosa ðŸŒ¹",
      "Te extraÃ±o mucho ðŸ’–",
      "Eres mi persona favorita ðŸ˜˜",
      "Siempre pienso en ti ðŸ¥°",
      "Â¡SonrÃ­e, mi amor! ðŸ˜Š",
      "TÃº eres mi cielo ðŸŒˆ",
      "Â¡Te amo infinito! ðŸ’ž",
      "Eres mi pixel preferido ðŸŸª",
      "Quiero abrazarte ya ðŸ«‚",
      "Â¡Eres mi razÃ³n de sonreÃ­r! ðŸ˜"
    ];

    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    ctx.imageSmoothingEnabled = false;

    const sprites = {
      idle: new Image(),
      walk: new Image()
    };
    sprites.idle.src = "sprites/idle.png";
    sprites.walk.src = "sprites/walk.png";

const sueloAltura = 50;

    let player = {
      x: 40,
      y: canvas.height - sueloAltura - 32,
      width: 32,
      height: 32,
      frame: 0,
      frameCount: 4,
      speed: 1.5,
      action: "idle",
      autoWalk: false
    };

    function nuevoMensaje() {
      let msg = mensajes[Math.floor(Math.random()*mensajes.length)];
      document.getElementById("mensaje").innerText = msg;
    }

    document.getElementById("btnMensaje").onclick = nuevoMensaje;
    document.getElementById("mensaje").onclick = nuevoMensaje;

    document.getElementById("btnAutoWalk").onclick = () => {
      player.autoWalk = true;
      player.action = "walk";
    };

    const musica = document.getElementById("musica");
    document.getElementById("btnMusica").onclick = () => {
      if (musica.paused) {
        musica.play();
      } else {
        musica.pause();
      }
    };

    const voz = document.getElementById("voz");
    document.getElementById("btnVoz").onclick = () => {
      voz.currentTime = 0;
      voz.play();
    };

    // --- ESCENARIO ---
    let estrellas = Array.from({length: 50}, () => ({
      x: Math.random()*canvas.width,
      y: Math.random()*(canvas.height - sueloAltura),
      brillo: Math.random()
    }));
    let fugaces = [];

    function generarFugaces() {
      let cantidad = Math.floor(Math.random()*4);
      for (let i=0; i<cantidad; i++) {
        fugaces.push({
          x: Math.random()*canvas.width,
          y: Math.random()*canvas.height/2,
          vx: -2 - Math.random()*2,
          vy: 1 + Math.random()*1,
          vida: 50 + Math.random()*50
        });
      }
    }
    setInterval(generarFugaces, 8000);

    function dibujarEscenario() {
      let hora = new Date().getHours();
      let colorCielo;
      if (hora >= 5 && hora < 8) colorCielo = '#FFB36B'; // amanecer
      else if (hora >= 8 && hora < 17) colorCielo = '#87CEEB'; // dÃ­a
      else if (hora >= 17 && hora < 19) colorCielo = '#FF7E5E'; // atardecer
      else colorCielo = '#0B0033'; // noche

      ctx.fillStyle = colorCielo;
      ctx.fillRect(0,0,canvas.width,canvas.height);

      if (hora >= 19 || hora < 5) {
        estrellas.forEach(e=>{
          e.brillo += (Math.random()-0.5)*0.1;
          e.brillo = Math.max(0.2, Math.min(1, e.brillo));
          ctx.fillStyle = `rgba(255,255,255,${e.brillo})`;
          ctx.fillRect(Math.floor(e.x), Math.floor(e.y), 1, 1);
        });
        fugaces.forEach(f=>{
          ctx.strokeStyle = 'white';
          ctx.beginPath();
          ctx.moveTo(f.x,f.y);
          ctx.lineTo(f.x+5,f.y-2);
          ctx.stroke();
          f.x += f.vx;
          f.y += f.vy;
          f.vida--;
        });
        fugaces = fugaces.filter(f=>f.vida>0);
      }

      ctx.fillStyle = '#228B22';
      ctx.fillRect(0,canvas.height - sueloAltura,canvas.width,sueloAltura);
    }

    let frameTimer = 0;
    function update() {
      frameTimer++;
      if (frameTimer % 10 === 0) player.frame = (player.frame + 1) % player.frameCount;

      if (player.autoWalk) {
        let center = (canvas.width - player.width) / 2;
        if (Math.abs(player.x - center) < 1) {
          player.x = center;
          player.autoWalk = false;
          player.action = "idle";
        } else {
          player.x += (player.x < center ? player.speed : -player.speed);
        }
      }

      draw();
      requestAnimationFrame(update);
    }

    function draw() {
      dibujarEscenario();
      let sprite = sprites[player.action];
      ctx.drawImage(
        sprite,
        player.frame * player.width, 0, player.width, player.height,
        player.x, player.y, player.width, player.height
      );
    }

    update();
  </script>
</body>
</html>
