<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <title>Pa' ti mi cachetona üíñ</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #222;
      font-family: 'Press Start 2P', Arial, sans-serif;
      text-align: center;
      height: 100%;
      width: 100vw;
    }
    body {
      width: 100vw;
      height: 100vh;
      min-height: 100vh;
      min-width: 100vw;
      box-sizing: border-box;
      position: relative;
    }
    h1 {
      margin: 10px 0 0 0;
      font-size: 5vw;
      color: #fff;
      text-shadow: 2px 2px 0 #000;
      letter-spacing: 2px;
      z-index: 2;
      position: relative;
    }
    #mensaje {
      background: rgba(0,0,0,0.7);
      color: #fff;
      padding: 10px 18px;
      border-radius: 12px;
      display: inline-block;
      margin: 12px auto 8px auto;
      font-size: 4vw;
      box-shadow: 0 2px 8px #0006;
      min-width: 60vw;
      max-width: 90vw;
      z-index: 2;
      position: relative;
    }
    #gameCanvas {
      display: block;
      margin: 0 auto;
      background: #222;
      width: 100vw;
      height: calc(100vh - 120px);
      max-width: 100vw;
      max-height: 100vh;
      image-rendering: pixelated;
      border: none;
      touch-action: none;
      position: absolute;
      left: 0;
      top: 0;
      z-index: 1;
    }
    .controles {
      position: fixed;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 18px;
      z-index: 10;
      width: 95vw;
      justify-content: center;
      flex-wrap: wrap;
    }
    .control-btn {
      background: #232946;
      border: 3px solid #ff66a3;
      color: #ff66a3;
      border-radius: 50%;
      width: 64px;
      height: 64px;
      font-size: 2.2rem;
      box-shadow: 0 2px 8px #0006;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 2px;
      transition: background 0.2s, color 0.2s;
      cursor: pointer;
      font-family: inherit;
      user-select: none;
    }
    .control-btn:active {
      background: #ff66a3;
      color: #232946;
    }
    .speed-btn {
      border: 3px solid #ffe066;
      color: #ffe066;
      background: #232946;
      margin-left: 8px;
      margin-right: 8px;
    }
    .speed-btn.active {
      background: #ffe066;
      color: #232946;
    }
    .msg-btn {
      border: 3px solid #fff700;
      color: #fff700;
      background: #232946;
      margin-left: 8px;
    }
    .msg-btn:active {
      background: #fff700;
      color: #232946;
    }
    @media (max-width: 600px) {
      h1 { font-size: 7vw; }
      #mensaje { font-size: 5vw; }
      .control-btn { width: 48px; height: 48px; font-size: 1.5rem; }
    }
  </style>
</head>
<body>
  <h1>üéÆ Pa' ti mi cachetona üíñ</h1>
  <div id="mensaje">Pa‚Äô ti mi cachetona hermosa üåπ</div>
  <canvas id="gameCanvas"></canvas>
  <div class="controles">
    <button id="btnLeft" class="control-btn">‚óÄÔ∏è</button>
    <button id="btnIdle" class="speed-btn control-btn" title="Quieto">‚è∏Ô∏è</button>
    <button id="btnWalk" class="speed-btn control-btn active" title="Caminar">üö∂</button>
    <button id="btnRun" class="speed-btn control-btn" title="Correr">üèÉ</button>
    <button id="btnRight" class="control-btn">‚ñ∂Ô∏è</button>
    <button id="btnMensaje" class="msg-btn control-btn" title="Nuevo mensajito">üíå</button>
  </div>
  <script>
    // --- CONFIGURACI√ìN ---
    const mensajes = [
      "Pa‚Äô ti mi cachetona hermosa üåπ",
      "Te extra√±o mucho üíñ",
      "Eres mi persona favorita üòò",
      "Siempre pienso en ti ü•∞",
      "¬°Sonr√≠e, mi amor! üòä",
      "T√∫ eres mi cielo üåà",
      "¬°Te amo infinito! üíû",
      "Eres mi pixel preferido üü™",
      "Quiero abrazarte ya ü´Ç",
      "¬°Eres mi raz√≥n de sonre√≠r! üòç"
    ];

    // --- CANVAS ---
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    ctx.imageSmoothingEnabled = false;

    // --- AJUSTAR CANVAS A PANTALLA ---
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight - 120;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // --- SPRITES (PERSONAJE) ---
    const sprites = {
      idle: new Image(),
      walk: new Image(),
      run: new Image()
    };
    sprites.idle.src = "sprites/idle.png";
    sprites.walk.src = "sprites/walk.png";
    sprites.run.src = "sprites/run.png";

    // --- PERSONAJE ---
    let player = {
      x: 40,
      y: 0,
      width: 32,
      height: 32,
      frame: 0,
      frameCount: 4,
      speed: 1.2,
      action: "walk"
    };
    let keys = { left: false, right: false, action: "walk" };

    // --- PAISAJE DIN√ÅMICO ---
    function getSkyState() {
      const now = new Date();
      const h = now.getHours() + now.getMinutes()/60;
      if (h >= 5 && h < 7) return "dawn";
      if (h >= 7 && h < 17) return "day";
      if (h >= 17 && h < 19) return "sunset";
      return "night";
    }

    // --- NUBES PIXELART BONITAS ---
    function drawCloud(x, y, scale=1) {
      ctx.save();
      ctx.translate(x, y);
      ctx.scale(scale, scale);
      ctx.fillStyle = "#fff";
      ctx.fillRect(4, 6, 16, 8);
      ctx.fillRect(0, 10, 24, 8);
      ctx.fillRect(8, 2, 8, 8);
      ctx.restore();
    }

    // --- LUNA PIXELART ---
    function drawMoon(x, y) {
      ctx.save();
      ctx.translate(x, y);
      ctx.fillStyle = "#fffbe6";
      ctx.beginPath();
      ctx.arc(0, 0, 18, 0, Math.PI*2);
      ctx.fill();
      ctx.globalCompositeOperation = "destination-out";
      ctx.beginPath();
      ctx.arc(4, 0, 14, 0, Math.PI*2);
      ctx.fill();
      ctx.globalCompositeOperation = "source-over";
      ctx.restore();
    }

    // --- SOL PIXELART ---
    function drawSun(x, y) {
      ctx.save();
      ctx.translate(x, y);
      ctx.fillStyle = "#ffe066";
      ctx.beginPath();
      ctx.arc(0, 0, 10, 0, Math.PI*2);
      ctx.fill();
      // rayos
      ctx.strokeStyle = "#ffe066";
      ctx.lineWidth = 2;
      for(let i=0;i<8;i++){
        ctx.beginPath();
        ctx.moveTo(0,0);
        ctx.lineTo(Math.cos(i*Math.PI/4)*14, Math.sin(i*Math.PI/4)*14);
        ctx.stroke();
      }
      ctx.restore();
    }

    // --- FLORES PIXELART ---
    function drawFlower(x, y) {
      ctx.save();
      ctx.translate(x, y);
      ctx.fillStyle = "#3cb371";
      ctx.fillRect(6, 10, 2, 6); // tallo
      ctx.fillStyle = "#ff66a3";
      ctx.beginPath();
      ctx.arc(7, 10, 3, 0, Math.PI*2);
      ctx.fill();
      ctx.fillStyle = "#fff700";
      ctx.beginPath();
      ctx.arc(7, 10, 1, 0, Math.PI*2);
      ctx.fill();
      ctx.restore();
    }

    // --- CORAZONES PIXELART ---
    function drawHeart(x, y, scale=1) {
      ctx.save();
      ctx.translate(x, y);
      ctx.scale(scale, scale);
      ctx.fillStyle = "#ff66a3";
      ctx.beginPath();
      ctx.moveTo(8, 12);
      ctx.bezierCurveTo(8, 8, 0, 8, 0, 12);
      ctx.bezierCurveTo(0, 16, 8, 20, 8, 24);
      ctx.bezierCurveTo(8, 20, 16, 16, 16, 12);
      ctx.bezierCurveTo(16, 8, 8, 8, 8, 12);
      ctx.fill();
      ctx.restore();
    }

    // --- ESTRELLAS PIXELART ---
    function drawStar(x, y, bright=1) {
      ctx.save();
      ctx.globalAlpha = bright;
      ctx.fillStyle = "#fff";
      ctx.fillRect(x, y, 2, 2);
      ctx.fillRect(x-1, y+1, 1, 1);
      ctx.fillRect(x+2, y+1, 1, 1);
      ctx.restore();
    }

    // --- ESTRELLA FUGAZ PIXELART ---
    function drawShootingStar(star) {
      ctx.save();
      ctx.globalAlpha = star.alpha;
      ctx.strokeStyle = "#fff";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(star.x, star.y);
      ctx.lineTo(star.x - star.length * Math.cos(star.angle), star.y - star.length * Math.sin(star.angle));
      ctx.stroke();
      ctx.globalAlpha = star.alpha * 0.7;
      ctx.strokeStyle = "#ffe066";
      ctx.lineWidth = 1;
      ctx.beginPath();
      ctx.moveTo(star.x, star.y);
      ctx.lineTo(star.x - (star.length-6) * Math.cos(star.angle), star.y - (star.length-6) * Math.sin(star.angle));
      ctx.stroke();
      ctx.restore();
    }

    // --- ESTADO DEL PAISAJE ---
    let clouds = [
      {x: 30, y: 18, s: 1.2, dx: 0.08},
      {x: 120, y: 10, s: 1, dx: 0.06},
      {x: 220, y: 25, s: 0.8, dx: 0.04}
    ];
    let flowers = Array.from({length: 12}, (_,i) => ({
      x: 10 + i*25 + Math.random()*10, y: 120 + Math.random()*10
    }));
    let hearts = Array.from({length: 6}, () => ({
      x: Math.random()*320, y: 160+Math.random()*30, s: 0.7+Math.random()*0.7, speed: 0.2+Math.random()*0.2
    }));

    // --- ESTRELLAS ---
    let stars = Array.from({length: 40}, () => ({
      x: Math.random()*320, y: Math.random()*60, bright: Math.random()
    }));

    // --- ESTRELLA FUGAZ ---
    let shootingStar = null;
    let lastShooting = 0;

    // --- MENSAJE ALEATORIO ---
    function nuevoMensaje() {
      let msg = mensajes[Math.floor(Math.random()*mensajes.length)];
      document.getElementById("mensaje").innerText = msg;
      lanzarEstrellaFugaz();
    }

    // --- LANZAR ESTRELLA FUGAZ ---
    function lanzarEstrellaFugaz() {
      // Sale de un borde aleatorio y cruza el cielo en diagonal
      let fromLeft = Math.random() > 0.5;
      let yStart = Math.random()*40+10;
      let angle = (fromLeft ? Math.random()*0.5+0.2 : Math.PI-Math.random()*0.5-0.2);
      shootingStar = {
        x: fromLeft ? -20 : 340,
        y: yStart,
        vx: Math.cos(angle)*6,
        vy: Math.sin(angle)*6,
        alpha: 1,
        angle: angle,
        length: 32+Math.random()*16
      };
      lastShooting = Date.now();
    }

    // --- CONTROLES T√ÅCTILES Y BOTONES ---
    function addBtnEvents(btn, onDown, onUp) {
      btn.onmousedown = onDown;
      btn.onmouseup = onUp;
      btn.ontouchstart = (e) => { e.preventDefault(); onDown(); };
      btn.ontouchend = (e) => { e.preventDefault(); onUp(); };
    }
    addBtnEvents(document.getElementById("btnLeft"), () => { keys.left = true; }, () => { keys.left = false; });
    addBtnEvents(document.getElementById("btnRight"), () => { keys.right = true; }, () => { keys.right = false; });

    // --- VELOCIDAD Y ACCI√ìN ---
    function setAction(action) {
      keys.action = action;
      document.querySelectorAll('.speed-btn').forEach(btn => btn.classList.remove('active'));
      if(action === "idle") document.getElementById("btnIdle").classList.add('active');
      if(action === "walk") document.getElementById("btnWalk").classList.add('active');
      if(action === "run") document.getElementById("btnRun").classList.add('active');
    }
    document.getElementById("btnIdle").onclick = () => setAction("idle");
    document.getElementById("btnWalk").onclick = () => setAction("walk");
    document.getElementById("btnRun").onclick = () => setAction("run");
    document.getElementById("btnMensaje").onclick = nuevoMensaje;

    // --- ANIMACI√ìN PRINCIPAL ---
    let frameTimer = 0;
    function update() {
      frameTimer++;
      // --- Animaci√≥n personaje ---
      if (frameTimer % 10 === 0) player.frame = (player.frame + 1) % player.frameCount;
      // --- Movimiento personaje ---
      let spd = player.speed * (keys.action === "run" ? 2.2 : keys.action === "walk" ? 1 : 0);
      if (keys.left) player.x -= spd;
      if (keys.right) player.x += spd;
      player.x = Math.max(0, Math.min(canvas.width - player.width, player.x));
      player.action = keys.action;

      // --- Animar nubes ---
      clouds.forEach(cl => {
        cl.x += cl.dx;
        if (cl.x > 340) cl.x = -40;
      });

      // --- Animar corazones flotando ---
      hearts.forEach(h => {
        h.y -= h.speed;
        if (h.y < -10) {
          h.y = 160+Math.random()*30;
          h.x = Math.random()*320;
        }
      });

      // --- Animar estrellas titilando ---
      if (getSkyState() === "sunset" || getSkyState() === "night") {
        stars.forEach(s => {
          s.bright += (Math.random()-0.5)*0.1;
          s.bright = Math.max(0.3, Math.min(1, s.bright));
        });
      }

      // --- Estrella fugaz autom√°tica cada 8s ---
      if (!shootingStar && Date.now() - lastShooting > 8000) lanzarEstrellaFugaz();

      // --- Animar estrella fugaz ---
      if (shootingStar) {
        shootingStar.x += shootingStar.vx;
        shootingStar.y += shootingStar.vy;
        shootingStar.alpha -= 0.018;
        if (
          shootingStar.alpha <= 0 ||
          shootingStar.x < -40 || shootingStar.x > 360 ||
          shootingStar.y < -20 || shootingStar.y > 100
        ) shootingStar = null;
      }

      draw();
      requestAnimationFrame(update);
    }

    // --- DIBUJAR TODO ---
    function draw() {
      // --- Fondo cielo seg√∫n hora ---
      let sky = getSkyState();
      if (sky === "dawn") {
        let grad = ctx.createLinearGradient(0,0,0,160);
        grad.addColorStop(0, "#f9d29d");
        grad.addColorStop(1, "#a1c4fd");
        ctx.fillStyle = grad;
      } else if (sky === "day") {
        ctx.fillStyle = "#87ceeb";
      } else if (sky === "sunset") {
        let grad = ctx.createLinearGradient(0,0,0,160);
        grad.addColorStop(0, "#fcb69f");
        grad.addColorStop(1, "#a1c4fd");
        ctx.fillStyle = grad;
      } else {
        ctx.fillStyle = "#232946";
      }
      ctx.fillRect(0,0,320,160);

      // --- Sol/Luna ---
      if (sky === "dawn") drawSun(260, 28);
      if (sky === "day") drawSun(260, 24);
      if (sky === "sunset") drawSun(260, 38);
      if (sky === "night") drawMoon(260, 24);

      // --- Nubes ---
      if (sky !== "night") clouds.forEach(cl => drawCloud(cl.x, cl.y, cl.s));
      else clouds.forEach(cl => drawCloud(cl.x, cl.y, cl.s*0.8));

      // --- Estrellas ---
      if (sky === "sunset" || sky === "night") {
        stars.forEach(s => drawStar(s.x, s.y, s.bright));
      }

      // --- Estrella fugaz ---
      if (shootingStar) drawShootingStar(shootingStar);

      // --- Lago pixelart ---
      ctx.fillStyle = "#1e90ff";
      ctx.fillRect(0, 120, 320, 20);

      // --- C√©sped pixelart ---
      ctx.fillStyle = "#3cb371";
      ctx.fillRect(0, 110, 320, 12);

      // --- Flores pixelart ---
      flowers.forEach(f => drawFlower(f.x, f.y));

      // --- Corazones flotando pixelart ---
      hearts.forEach(h => drawHeart(h.x, h.y, h.s));

      // --- Personaje ---
      let sprite = sprites[player.action];
      ctx.drawImage(
        sprite,
        player.frame * player.width, 0, player.width, player.height,
        player.x, player.y, player.width, player.height
      );
    }

    // --- INICIAR ---
    document.getElementById("mensaje").onclick = nuevoMensaje;
    update();
  </script>
</body>
</html>