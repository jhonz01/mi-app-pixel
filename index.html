<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pa' ti mi cachetona ðŸ’–</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #222;
      font-family: 'Press Start 2P', Arial, sans-serif;
      text-align: center;
      height: 100%;
      width: 100vw;
    }
    h1 {
      margin: 10px 0 0 0;
      font-size: 5vw;
      color: #fff;
      text-shadow: 2px 2px 0 #000;
      letter-spacing: 2px;
    }
    #mensaje {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.7);
      color: #fff;
      padding: 10px 18px;
      border-radius: 12px;
      display: inline-block;
      font-size: 4vw;
      box-shadow: 0 2px 8px #0006;
      min-width: 60vw;
      max-width: 90vw;
      z-index: 9;
    }
    #gameCanvas {
      display: block;
      margin: 0 auto;
      background: #222;
      width: 100vw;
      max-width: 100vw;
      height: 60vw;
      max-height: 70vw;
      image-rendering: pixelated;
      border: 2px solid #333;
    }
    .controles {
      position: fixed;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      z-index: 10;
      width: 95vw;
      justify-content: center;
      flex-wrap: wrap;
    }
    .controles button {
      background: #222;
      border: 4px solid #fff;
      color: #fff;
      font-family: 'Press Start 2P', Arial, sans-serif;
      font-size: 3vw;
      padding: 8px 12px;
      cursor: pointer;
      image-rendering: pixelated;
      box-shadow: 4px 4px 0 #000;
      transition: all 0.1s;
      min-width: 80px;
    }
    .controles button:active {
      background: #ff66a3;
      color: #000;
      box-shadow: 2px 2px 0 #000;
      transform: translate(2px,2px);
    }
    @media (max-width: 600px) {
      h1 { font-size: 7vw; }
      #mensaje { font-size: 5vw; }
      #gameCanvas { height: 60vw; }
      .controles button { font-size: 4vw; min-width: 60px; }
    }
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
  </style>
</head>
<body>
  <h1>Pa' ti mi cachetona ðŸ’–</h1>
  <canvas id="gameCanvas" width="320" height="160"></canvas>
  <div id="mensaje">Paâ€™ ti mi cachetona hermosa ðŸŒ¹</div>
  <div class="controles">
    <button id="btnAutoWalk">MOVE</button>
    <button id="btnMusica">PLAY</button>
    <button id="btnVoz">VOICE</button>
    <button id="btnMensaje">MSG</button>
  </div>

  <audio id="musica" src="musica.mp3"></audio>
  <audio id="voz" src="mi_voz.mp3"></audio>

  <script>
'use strict';
console.clear();

const mensajes = [
  "Paâ€™ ti mi cachetona hermosa ðŸŒ¹",
  "Te extraÃ±o mucho ðŸ’–",
  "Eres mi persona favorita ðŸ˜˜",
  "Siempre pienso en ti ðŸ¥°",
  "Â¡SonrÃ­e, mi amor! ðŸ˜Š",
  "TÃº eres mi cielo ðŸŒˆ",
  "Â¡Te amo infinito! ðŸ’ž",
  "Eres mi pixel preferido ðŸŸª",
  "Quiero abrazarte ya ðŸ«‚",
  "Â¡Eres mi razÃ³n de sonreÃ­r! ðŸ˜"
];

const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
ctx.imageSmoothingEnabled = false;

// === SPRITES ===
const sprites = {
  idle: new Image(),
  walk: new Image(),
  ellaIdle: new Image(),
  ellaWalk: new Image(),
  corazones: new Image()
};
sprites.idle.src = "sprites/idle.png";
sprites.walk.src = "sprites/walk.png";
sprites.ellaIdle.src = "sprites/ella_idle.png";
sprites.ellaWalk.src = "sprites/ella_walk.png";
sprites.corazones.src = "sprites/corazones_animados.png";

// === PERSONAJES ===
let player = { x: 0, y: canvas.height - 64, width: 32, height: 32, frame: 0, frameCount: 4, speed: 1.5, action: "idle", autoWalk: false };
let ella = { x: canvas.width - 32, y: canvas.height - 64, width: 32, height: 32, frame: 0, frameCount: 4, speed: 1.5, action: "idle", autoWalk: false };

// === MENSAJES ===
function nuevoMensaje() {
  document.getElementById("mensaje").innerText = mensajes[Math.floor(Math.random()*mensajes.length)];
}
document.getElementById("btnMensaje").onclick = nuevoMensaje;
document.getElementById("mensaje").onclick = nuevoMensaje;

// === CONTROLES ===
document.getElementById("btnAutoWalk").onclick = () => {
  player.x = 0;
  ella.x = canvas.width - ella.width;
  player.action = "walk";
  ella.action = "walk";
  player.autoWalk = true;
  ella.autoWalk = true;
  corazonesActivos = [];
};

const musica = document.getElementById("musica");
document.getElementById("btnMusica").onclick = () => musica.paused ? musica.play() : musica.pause();
const voz = document.getElementById("voz");
document.getElementById("btnVoz").onclick = () => { voz.currentTime = 0; voz.play(); };

// === CORAZONES NUEVOS ===
let corazonesActivos = [];
let frameCorazon = 0;
const anchoCorazon = 22; // 286px / 13 â‰ˆ 22px por frame
const altoCorazon = 60;
let frameTimer = 0;

// === DIBUJAR ===
function dibujar() {
  ctx.fillStyle = "#222";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // Dibujar personajes
  ctx.drawImage(sprites[player.action], player.frame * player.width, 0, player.width, player.height, player.x, player.y, player.width, player.height);
  ctx.save();
  ctx.translate(ella.x + ella.width, ella.y);
  ctx.scale(-1,1);
  ctx.drawImage(sprites["ella"+capitalize(ella.action)], ella.frame * ella.width, 0, ella.width, ella.height, 0, 0, ella.width, ella.height);
  ctx.restore();

  // Dibujar corazones cuando ambos estÃ©n en idle y en el centro
  if (player.action === "idle" && ella.action === "idle") {
    const centroX = (player.x + ella.x + player.width) / 2 - anchoCorazon / 2;
    const centroY = player.y - altoCorazon + 10;
    ctx.drawImage(sprites.corazones, frameCorazon * anchoCorazon, 0, anchoCorazon, altoCorazon, centroX, centroY, anchoCorazon, altoCorazon);
  }
}

// === ACTUALIZAR ===
function update() {
  frameTimer++;
  if (frameTimer % 10 === 0){
    player.frame = (player.frame + 1) % player.frameCount;
    ella.frame = (ella.frame + 1) % ella.frameCount;
    frameCorazon = (frameCorazon + 1) % 13;
  }

  let centroX = (canvas.width - player.width)/2 - player.width/2;
  let centroElla = (canvas.width - ella.width)/2 + ella.width/2;

  if (player.autoWalk) {
    if (player.x < centroX) player.x += player.speed; else {player.x = centroX;player.action = "idle";}
  }
  if (ella.autoWalk) {
    if (ella.x > centroElla) ella.x -= ella.speed; else {ella.x = centroElla;ella.action = "idle";}
  }

  dibujar();
  requestAnimationFrame(update);
}

function capitalize(str){ return str.charAt(0).toUpperCase()+str.slice(1); }

update();
  </script>
</body>
</html>
